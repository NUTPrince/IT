# Git 的基础操作
## 修改、提交、推送

首先先来理解下 Git 工作区、暂存区和版本库概念：

![[g-5.png]]

-   **工作区**：本地工作目录的文件夹

-   **版本库**：工作区有一个隐藏目录 .git，其是 Git 的版本库（`.git 文件夹`：初次对本地文件夹使用 `git init` 命令，即可得到）

-   **暂存区**：一般存放在 .git 目录下的 index 文件（.git/index）中

**故把本地修改的文件推送到GitHub，分以下三步执行的：**

1. 《 **修改** 保存到暂存区》：先查看查看整个仓库的状态,使用`git status`命令:

```shell
git status
```

若有更改未提交，再使用`git add`命令，把文件修改添加到暂存区：

```shell
git add .
```

2. 《 **提交** 至本地版本库》：用`git commit`提交更改到版本库（当前分支->main）
(在初始化创建Git版本库时，Git自动为我们创建了唯一一个`main`分支，所以，现在，`git commit`就是往`main`分支上提交更改。)

```shell
git commit -m "xxx"
```

3. 《然后 **推送** 到 GitHub 远程仓库》：

使用命令：
```shell
git push
```
然后等待即可。

而后可查看提交历史，使用命令 `git log`，它用来查看版本库的提交历史记录。

```shell
$ git log

> commit d98c961257dcc92863a5a792749b1e94caab69c2 (**HEAD ->** **main**, **origin/main**)
```

>执行 `git log` 查看提交记录时，十六进制序列号就是提交版本号，这是很重要的信息，每个提交都有自己单独的版本号，就像公民身份证号一样。


## 版本回退撤销修改

发现文件内容有误需要修改，但是已经推送到版本库，怎么办？

### 方法一（正向推送）：

修改此文件后，重新推送一次覆盖，将文件添加到暂存区（`git add`）-> 提交（`git commit`）-> 推送（`git push`）。

### 方法二（逆向回退）：

分多种情况，先上图（虚线箭头为逆向回退）

![[g-6.png]]


#### 版本库的回滚与撤销

- 撤销当前提交回至 **暂存区**：

```shell
git reset  --sort [版本号]     

```
版本号用 `git log` 可查看，输入前5～7位即可。

- 回滚的版本到 **工作区**（工作区中未修改的文件区域）:
```shell
git reset  --hard [版本号]
```

- 回滚的版本回到 **工作区**（工作区中已修改的文件区域）：
```shell
git reset  --mix [版本号]
```

#### 暂存区的撤销

- 将 **暂存区** 里的文件或文件夹移到 **工作区** :

```shell
git reset -- [文件名]
```

#### 工作区的撤销

将工作区里的 **修改状态** 移到工作区 **未修改状态** :

```shell
git checkout -- [文件名]
```

#### 后悔药

>首先，Git必须知道当前版本是哪个版本，在Git中，用`HEAD`表示当前版本，上一个版本就是`HEAD^`，上上一个版本就是`HEAD^^`，表示第 n 个写成`HEAD~n`。

查看所有历史版本信息 （包括回滚或删除过的）：
```shell
git reflog
```

输出：
```shell
225f966 HEAD@{5}: pull -r origin main (pick): first commit
```
例如，其中 `225f966`  为第一次提交的版本

找到需要回到的版本号，再使用回滚撤销命令即可。
例如：
```shell
git reset --hard 225f966
```

输出：
```shell
HEAD is now at 225f96 append GPL
```

# 小彩蛋

>介绍一个超级实用、使用频率极高的命令

查看分支信息:
```shell
git branch -avv
```

可显示每个（本地）分支当前指向的提交记录的哈希值，以及和其上游分支的相对位置（如果有的话）。

